global:
  scrape_interval: 15s

scrape_configs:
- job_name: API
  static_configs:
  - targets:
    - '192.168.100.1:8000'
- job_name: discord
  static_configs:
  - targets:
    - '192.168.100.10:8787'
- job_name: node
  static_configs:
  - targets: 
{% for host in hostvars.items() %}
{% if 'nebula_ip' in host[1] %}
    - {{ host[1]['nebula_ip'] }}:9100
{% endif %}
{% endfor %}
- job_name: tickers
  static_configs:
  - targets:
{% for host in hostvars.items() %}
{% if 'clients' in host[1] %}
{% for client in host[1]['clients'] %}
    - {{ host[1]['nebula_ip'] }}:{{ host[1]['clients'][client]['port'] }}
{% endfor %}
{% endif %}
{% endfor %}
