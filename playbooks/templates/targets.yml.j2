global:
  scrape_interval: 15s

scrape_configs:

# - job_name: discord
#   static_configs:
#   - targets:
#     - '192.168.0.11:8787'

- job_name: bot-manager
  static_configs:
  - targets:
    - '192.168.0.11:7777'

- job_name: digitalocean
  static_configs:
  - targets:
    - '192.168.0.11:8789'

- job_name: omada
  static_configs:
  - targets:
    - '192.168.0.11:9202'

# - job_name: plex
#   static_configs:
#   - targets:
#     - '192.168.0.11:9594'

# - job_name: chihaya
#   static_configs:
#     - targets:
#       - '192.168.101.30:6880'

# - job_name: bigblackbox
#   static_configs:
#     - targets:
#       - '10.253.0.1:9100'

- job_name: pushgateway
  static_configs:
    - targets:
      - '192.168.0.11:9092'
  honor_labels: true

# - job_name: caddy
#   static_configs:
#     - targets:
#       - '192.168.0.11:2019'

- job_name: node
  static_configs:
{% for host in hostvars.items() %}
{% if 'tailscale_ip' in host[1] %}
  - targets: [ '{{ host[1]['tailscale_ip'] }}:9100' ]
    labels:
      instance: '{{ host[1]['inventory_hostname'] }}'
{% endif %}
{% endfor %}

- job_name: coingecko_cache
  static_configs:
{% for host in hostvars.items() %}
{% if 'tailscale_ip' in host[1] %}
  - targets: [ '{{ host[1]['tailscale_ip'] }}:6380' ]
    labels:
      instance: '{{ host[1]['inventory_hostname'] }}'
{% endif %}
{% endfor %}

- job_name: tickers
  static_configs:
{% for host in hostvars.items() %}
{% if 'tailscale_ip' in host[1] %}
{% if 'clients' in host[1] %}
{% for client in host[1]['clients'] %}
  - targets: [ '{{ host[1]['tailscale_ip'] }}:{{ host[1]['clients'][client] }}' ]
    labels:
      instance: '{{ host[1]['inventory_hostname'] }}'
      client: '{{ client }}'
{% endfor %}
{% endif %}
{% endif %}
{% endfor %}
